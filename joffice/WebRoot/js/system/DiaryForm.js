var DiaryForm=function(a){this.diaryId=a;var b=this.setup();var c=new Ext.Window({id:"DiaryFormWin",title:"日志详细信息",iconCls:"menu-diary",maximizable:true,width:650,height:450,modal:true,layout:"fit",buttonAlign:"center",items:[this.setup()],buttons:[{text:"保存",iconCls:"btn-save",handler:function(){var d=Ext.getCmp("DiaryForm");if(d.getForm().isValid()){d.getForm().submit({method:"post",waitMsg:"正在提交数据...",success:function(e,f){Ext.ux.Toast.msg("操作信息","成功信息保存！");Ext.getCmp("DiaryGrid").getStore().reload();c.close();},failure:function(e,f){Ext.MessageBox.show({title:"操作信息",msg:"信息保存出错，请联系管理员！",buttons:Ext.MessageBox.OK,icon:"ext-mb-error"});c.close();}});}}},{text:"取消",iconCls:"btn-cancel",handler:function(){c.close();}}]});c.show();};DiaryForm.prototype.setup=function(){var a=new Ext.FormPanel({url:__ctxPath+"/system/saveDiary.do",layout:"form",id:"DiaryForm",frame:false,border:false,bodyStyle:"padding:5px;",defaults:{widht:400,anchor:"100%,100%"},formId:"DiaryFormId",defaultType:"textfield",items:[{name:"diary.diaryId",id:"diaryId",xtype:"hidden",value:this.diaryId==null?"":this.diaryId},{xtype:"hidden",name:"diary.appUser.userId",id:"userId"},{fieldLabel:"日期",xtype:"datefield",name:"diary.dayTime",id:"dayTime",editable:false,format:"Y-m-d"},{fieldLabel:"日志类型",xtype:"combo",hiddenName:"diary.diaryType",id:"diaryType",mode:"local",editable:false,value:"0",triggerAction:"all",store:[["0","个人日志"],["1","工作日志"]]},{fieldLabel:"内容",xtype:"htmleditor",name:"diary.content",id:"content"}]});if(this.diaryId!=null&&this.diaryId!="undefined"){a.getForm().load({deferredRender:false,url:__ctxPath+"/system/getDiary.do?diaryId="+this.diaryId,waitMsg:"正在载入数据...",success:function(d,e){var b=e.result.data;var c=getDateFromFormat(b.dayTime,"yyyy-MM-dd");Ext.getCmp("dayTime").setValue(new Date(c));},failure:function(b,c){Ext.ux.Toast.msg("编辑","载入失败");}});}return a;};