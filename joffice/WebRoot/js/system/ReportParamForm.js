var ReportParamForm=function(c,b){this.paramId=b;this.reportId=c;var a=this.setup();var d=new Ext.Window({id:"ReportParamFormWin",title:name+"详细信息",width:500,height:220,modal:true,layout:"anchor",plain:true,bodyStyle:"padding:5px;",buttonAlign:"center",items:[this.setup()],buttons:[{text:"保存",iconCls:"btn-save",handler:function(){var e=Ext.getCmp("ReportParamForm");if(e.getForm().isValid()){e.getForm().submit({method:"post",waitMsg:"正在提交数据...",success:function(f,g){Ext.ux.Toast.msg("操作信息","成功保存信息！");Ext.getCmp("ReportParamGrid").getStore().reload();d.close();},failure:function(f,g){Ext.MessageBox.show({title:"操作信息",msg:"信息保存出错，请联系管理员！",buttons:Ext.MessageBox.OK,icon:Ext.MessageBox.ERROR});d.close();}});}}},{text:"取消",iconCls:"btn-cancel",handler:function(){d.close();}}]});d.show();};ReportParamForm.prototype.setup=function(){var a=new Ext.FormPanel({url:__ctxPath+"/system/saveReportParam.do",layout:"form",id:"ReportParamForm",frame:true,defaults:{width:400,anchor:"98%,98%"},formId:"ReportParamFormId",defaultType:"textfield",items:[{name:"reportParam.paramId",id:"paramId",xtype:"hidden",value:this.paramId==null?"":this.paramId},{xtype:"hidden",name:"reportParam.reportId",value:this.reportId},{fieldLabel:"参数名称",name:"reportParam.paramName",id:"paramName",allowBlank:false},{fieldLabel:"参数Key",name:"reportParam.paramKey",id:"paramKey",allowBlank:false},{fieldLabel:"类型",hiddenName:"reportParam.paramType",id:"paramType",xtype:"combo",mode:"local",allowBlank:false,editable:false,triggerAction:"all",store:[["varchar","字符类型"],["int","整型"],["decimal","精度型"],["date","日期型"],["datetime","日期时间型"]],value:"varchar",listeners:{select:function(f,b,d){var e=f.value;var c=Ext.getCmp("ReportParamForm");c.remove("defaultVal");if(e=="date"){c.add({fieldLabel:"缺省值",name:"reportParam.defaultVal",id:"defaultVal",xtype:"datefield",format:"Y-m-d",allowBlank:false});}else{if(e=="datetime"){c.add({fieldLabel:"缺省值",name:"reportParam.defaultVal",id:"defaultVal",xtype:"datetimefield",format:"Y-m-d H:i:s",allowBlank:false});}else{if(e=="varchar"){c.add({fieldLabel:"缺省值",name:"reportParam.defaultVal",id:"defaultVal",allowBlank:false});}else{c.add({fieldLabel:"缺省值",name:"reportParam.defaultVal",id:"defaultVal",xtype:"numberfield",allowBlank:false});}}}c.doLayout(true);}}},{fieldLabel:"系列号",name:"reportParam.sn",id:"sn",allowBlank:false},{fieldLabel:"缺省值",name:"reportParam.defaultVal",id:"defaultVal",allowBlank:false}]});if(this.paramId!=null&&this.paramId!="undefined"){a.getForm().load({deferredRender:false,url:__ctxPath+"/system/getReportParam.do?paramId="+this.paramId,waitMsg:"正在载入数据...",success:function(d,f){var e=f.result.data.paramType;var b=f.result.data.defaultVal;var c=Ext.getCmp("ReportParamForm");c.remove("defaultVal");if(e=="date"){c.add({fieldLabel:"缺省值",name:"reportParam.defaultVal",id:"defaultVal",xtype:"datefield",format:"Y-m-d",allowBlank:false,value:b});}else{if(e=="datetime"){c.add({fieldLabel:"缺省值",name:"reportParam.defaultVal",id:"defaultVal",xtype:"datetimefield",format:"Y-m-d H:i:s",allowBlank:false,value:b});}else{if(e=="varchar"){c.add({fieldLabel:"缺省值",name:"reportParam.defaultVal",id:"defaultVal",allowBlank:false});}else{c.add({fieldLabel:"缺省值",name:"reportParam.defaultVal",id:"defaultVal",xtype:"numberfield",allowBlank:false});}}}c.doLayout(true);},failure:function(b,c){}});}return a;};