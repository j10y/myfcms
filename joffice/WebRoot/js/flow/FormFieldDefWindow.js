FormFieldDefWindow=Ext.extend(Ext.Window,{toolItems:[{type:"textfield",text:"文本框"},{type:"radio",text:"单选框"},{type:"checkbox",text:"复选框"},{type:"textarea",text:"多行文本框"},{type:"datefield",text:"日期"},{type:"datetimefield",text:"日期时间"}],constructor:function(a){Ext.applyIf(this,a);this.initUIComponents();FormFieldDefWindow.superclass.constructor.call(this,{height:500,width:800,maximizable:true,title:"流程任务表单定义-"+this.activityName,layout:"border",items:[this.canvasPanel,this.toolPanel],buttonAlign:"center",buttons:this.buttons});},initUIComponents:function(){this.canvasPanel=new Ext.Panel({bodyStyle:"padding:4px 4px 4px 4px",id:"canvasPanel",region:"center",id:"canvas",layout:"column",autoScroll:true});this.canvasPanel.on("render",this.onCanvasRender,this);this.toolPanel=new Ext.Panel({title:"表单组件",id:"toolPanel",region:"east",split:true,collapsible:true,width:130,defaults:{style:"margin-bottom: 5px",draggable:{insertProxy:false,onDrag:function(c){var b=this.proxy.getEl();this.x=b.getLeft(true);this.y=b.getTop(true);var a=this.panel.getEl().shadow;if(a){a.realign(this.x,this.y,b.getWidth(),b.getHeight());}},endDrag:function(a){this.panel.setPosition(this.x,this.y);}}},items:this.createToolItems()});this.buttons=[{text:"保存",iconCls:"btn-save",handler:function(){}},{text:"取消",iconCls:"btn-cancel",scope:this,handler:function(){this.close();}}];},onCanvasRender:function(b){var a=new Ext.dd.DropTarget(b.body.dom,{notifyDrop:function(i,h,f){var k=i.panel.getId();var d=k.split("_")[1];var j=d;var g=null;if(d=="datefield"){g="Y-m-d";}else{if(d=="datetimefield"){g="Y-m-d H:i:s";}}var c={columnWidth:0.5,border:false,xtype:"panel",layout:"form",draggable:{insertProxy:false},items:{xtype:d,border:false,labelStyle:"text-align:center;padding-top:4px",fieldLabel:"未命名",format:g}};b.add(c);b.doLayout();return true;}});},createToolItems:function(){var c=[];for(var a=0;a<this.toolItems.length;a++){var b=this.toolItems[a];c.push(new Ext.Panel({height:20,bodyStyle:"padding:2px 2px 2px 2px;border-bottom: solid 1px blue;",border:false,id:"panel_"+b.type,html:b.text}));}return c;}});