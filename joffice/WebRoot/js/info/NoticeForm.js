NoticeForm=Ext.extend(Ext.Window,{formPanel:null,constructor:function(a){Ext.applyIf(this,a);this.initUIComponents();NoticeForm.superclass.constructor.call(this,{layout:"fit",id:"NoticeFormWin",iconCls:"menu-notice",title:"公告详细信息",width:500,height:410,minWidth:499,minHeight:409,items:this.formPanel,maximizable:true,border:false,modal:true,plain:true,buttonAlign:"center",buttons:this.buttons});},initUIComponents:function(){this.formPanel=new Ext.FormPanel({url:__ctxPath+"/info/saveNotice.do",layout:"form",id:"NoticeForm",bodyStyle:"padding:5px;",frame:false,width:480,formId:"NoticeFormId",defaultType:"textfield",items:[{name:"notice.noticeId",id:"noticeId",xtype:"hidden",value:this.noticeId==null?"":this.noticeId},{fieldLabel:"发布者",name:"notice.postName",id:"postName",allowBlank:false,blankText:"发布者不能为空",anchor:"98%",value:curUserInfo.fullname},{fieldLabel:"公告标题",name:"notice.noticeTitle",id:"noticeTitle",allowBlank:false,blankText:"公告标题不能为空",anchor:"98%"},{fieldLabel:"公告内容",name:"notice.noticeContent",id:"noticeContent",xtype:"htmleditor",height:200,allowBlank:false,blankText:"公告内容不能为空",anchor:"98%"},{fieldLabel:"生效日期",name:"notice.effectiveDate",id:"effectiveDate",xtype:"datefield",format:"Y-m-d",anchor:"98%"},{fieldLabel:"失效日期",name:"notice.expirationDate",id:"expirationDate",xtype:"datefield",format:"Y-m-d",anchor:"98%"},{xtype:"combo",fieldLabel:"发布状态",allowBlank:false,hiddenName:"notice.state",id:"state",emptyText:"请选择发布状态",mode:"local",editable:false,triggerAction:"all",store:[["0","草稿"],["1","立即发布"]],anchor:"98%",value:"1"}]});if(this.noticeId!=null&&this.noticeId!="undefined"){this.formPanel.getForm().load({deferredRender:false,url:__ctxPath+"/info/getNotice.do?noticeId="+this.noticeId,waitMsg:"正在载入数据...",success:function(b,c){var d=c.result.data.effectiveDate;var e=Ext.getCmp("effectiveDate");var a=c.result.data.expirationDate;var f=Ext.getCmp("expirationDate");e.setValue(new Date(getDateFromFormat(d,"yyyy-MM-dd HH:mm:ss")));if(a!=null){f.setValue(new Date(getDateFromFormat(a,"yyyy-MM-dd HH:mm:ss")));}},failure:function(a,b){Ext.ux.Toast.msg("编辑","载入失败");}});}this.buttons=[{text:"保存",iconCls:"btn-save",handler:function(){var a=Ext.getCmp("NoticeForm");if(a.getForm().isValid()){a.getForm().submit({method:"post",waitMsg:"正在提交数据...",success:function(b,c){Ext.ux.Toast.msg("操作信息","成功保存信息！");Ext.getCmp("NoticeGrid").getStore().reload();Ext.getCmp("NoticeFormWin").close();},failure:function(b,c){Ext.MessageBox.show({title:"操作信息",msg:"信息保存出错，请联系管理员！",buttons:Ext.MessageBox.OK,icon:"ext-mb-error"});Ext.getCmp("NoticeFormWin").close();}});}}},{text:"取消",iconCls:"btn-cancel",handler:function(){Ext.getCmp("NoticeFormWin").close();}}];}});