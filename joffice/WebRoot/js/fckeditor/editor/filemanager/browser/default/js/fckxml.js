var FCKXml=function(){};FCKXml.prototype.GetHttpRequest=function(){try{return new XMLHttpRequest();}catch(a){}try{return new ActiveXObject("Msxml2.XMLHTTP");}catch(a){}try{return new ActiveXObject("Microsoft.XMLHTTP");}catch(a){}return null;};FCKXml.prototype.LoadUrl=function(d,a){var b=this;var c=(typeof(a)=="function");var e=this.GetHttpRequest();e.open("GET",d,c);if(c){e.onreadystatechange=function(){if(e.readyState==4){var f;try{var h=e.responseXML.firstChild;f=e.responseXML;}catch(g){try{f=(new DOMParser()).parseFromString(e.responseText,"text/xml");}catch(g){}}if(!f||!f.firstChild||f.firstChild.nodeName=="parsererror"){alert("The server didn't send back a proper XML response. Please contact your system administrator.\n\n"+"XML request error: "+e.statusText+" ("+e.status+")\n\n"+"Requested URL:\n"+d+"\n\n"+"Response text:\n"+e.responseText);return;}b.DOMDocument=f;a(b);}};}e.send(null);if(!c){if(e.status==200||e.status==304){this.DOMDocument=e.responseXML;}else{alert("XML request error: "+e.statusText+" ("+e.status+")");}}};FCKXml.prototype.SelectNodes=function(a){if(navigator.userAgent.indexOf("MSIE")>=0){return this.DOMDocument.selectNodes(a);}else{var c=new Array();var b=this.DOMDocument.evaluate(a,this.DOMDocument,this.DOMDocument.createNSResolver(this.DOMDocument.documentElement),XPathResult.ORDERED_NODE_ITERATOR_TYPE,null);if(b){var d=b.iterateNext();while(d){c[c.length]=d;d=b.iterateNext();}}return c;}};FCKXml.prototype.SelectSingleNode=function(a){if(navigator.userAgent.indexOf("MSIE")>=0){return this.DOMDocument.selectSingleNode(a);}else{var b=this.DOMDocument.evaluate(a,this.DOMDocument,this.DOMDocument.createNSResolver(this.DOMDocument.documentElement),9,null);if(b&&b.singleNodeValue){return b.singleNodeValue;}else{return null;}}};