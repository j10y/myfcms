var FCKJustifyCommand=function(b){this.AlignValue=b;var c=FCKConfig.ContentLangDirection.toLowerCase();this.IsDefaultAlign=(b=="left"&&c=="ltr")||(b=="right"&&c=="rtl");var a=this._CssClassName=(function(){var d=FCKConfig.JustifyClasses;if(d){switch(b){case"left":return d[0]||null;case"center":return d[1]||null;case"right":return d[2]||null;case"justify":return d[3]||null;}}return null;})();if(a&&a.length>0){this._CssClassRegex=new RegExp("(?:^|\\s+)"+a+"(?=$|\\s)");}};FCKJustifyCommand._GetClassNameRegex=function(){var d=FCKJustifyCommand._ClassRegex;if(d!=undefined){return d;}var e=[];var b=FCKConfig.JustifyClasses;if(b){for(var a=0;a<4;a++){var c=b[a];if(c&&c.length>0){e.push(c);}}}if(e.length>0){d=new RegExp("(?:^|\\s+)(?:"+e.join("|")+")(?=$|\\s)");}else{d=null;}return FCKJustifyCommand._ClassRegex=d;};FCKJustifyCommand.prototype={Execute:function(){FCKUndo.SaveUndoStep();var b=new FCKDomRange(FCK.EditorWindow);b.MoveToSelection();var g=this.GetState();if(g==FCK_TRISTATE_DISABLED){return;}var f=b.CreateBookmark();var a=this._CssClassName;var e=new FCKDomRangeIterator(b);var h;while((h=e.GetNextParagraph())){h.removeAttribute("align");if(a){var d=h.className.replace(FCKJustifyCommand._GetClassNameRegex(),"");if(g==FCK_TRISTATE_OFF){if(d.length>0){d+=" ";}h.className=d+a;}else{if(d.length==0){FCKDomTools.RemoveAttribute(h,"class");}}}else{var c=h.style;if(g==FCK_TRISTATE_OFF){c.textAlign=this.AlignValue;}else{c.textAlign="";if(c.cssText.length==0){h.removeAttribute("style");}}}}b.MoveToBookmark(f);b.Select();FCK.Focus();FCK.Events.FireEvent("OnSelectionChange");},GetState:function(){if(FCK.EditMode!=FCK_EDITMODE_WYSIWYG||!FCK.EditorWindow){return FCK_TRISTATE_DISABLED;}var c=new FCKElementPath(FCKSelection.GetBoundaryParentElement(true));var a=c.Block||c.BlockLimit;if(!a||a.nodeName.toLowerCase()=="body"){return FCK_TRISTATE_OFF;}var b;if(FCKBrowserInfo.IsIE){b=a.currentStyle.textAlign;}else{b=FCK.EditorWindow.getComputedStyle(a,"").getPropertyValue("text-align");}b=b.replace(/(-moz-|-webkit-|start|auto)/i,"");if((!b&&this.IsDefaultAlign)||b==this.AlignValue){return FCK_TRISTATE_ON;}return FCK_TRISTATE_OFF;}};