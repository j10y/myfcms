var FCKTextColorCommand=function(b){this.Name=b=="ForeColor"?"TextColor":"BGColor";this.Type=b;var a;if(FCKBrowserInfo.IsIE){a=window;}else{if(FCK.ToolbarSet._IFrame){a=FCKTools.GetElementWindow(FCK.ToolbarSet._IFrame);}else{a=window.parent;}}this._Panel=new FCKPanel(a);this._Panel.AppendStyleSheet(FCKConfig.SkinEditorCSS);this._Panel.MainNode.className="FCK_Panel";this._CreatePanelBody(this._Panel.Document,this._Panel.MainNode);FCK.ToolbarSet.ToolbarItems.GetItem(this.Name).RegisterPanel(this._Panel);FCKTools.DisableSelection(this._Panel.Document.body);};FCKTextColorCommand.prototype.Execute=function(c,b,a){this._Panel.Show(c,b,a);};FCKTextColorCommand.prototype.SetColor=function(a){FCKUndo.SaveUndoStep();var b=FCKStyles.GetStyle("_FCK_"+(this.Type=="ForeColor"?"Color":"BackColor"));if(!a||a.length==0){FCK.Styles.RemoveStyle(b);}else{b.SetVariable("Color",a);FCKStyles.ApplyStyle(b);}FCKUndo.SaveUndoStep();FCK.Focus();FCK.Events.FireEvent("OnSelectionChange");};FCKTextColorCommand.prototype.GetState=function(){if(FCK.EditMode!=FCK_EDITMODE_WYSIWYG){return FCK_TRISTATE_DISABLED;}return FCK_TRISTATE_OFF;};function FCKTextColorCommand_OnMouseOver(){this.className="ColorSelected";}function FCKTextColorCommand_OnMouseOut(){this.className="ColorDeselected";}function FCKTextColorCommand_OnClick(b,c,a){this.className="ColorDeselected";c.SetColor(a);c._Panel.Hide();}function FCKTextColorCommand_AutoOnClick(a,b){this.className="ColorDeselected";b.SetColor("");b._Panel.Hide();}function FCKTextColorCommand_MoreOnClick(a,b){this.className="ColorDeselected";b._Panel.Hide();FCKDialog.OpenDialog("FCKDialog_Color",FCKLang.DlgColorTitle,"dialog/fck_colorselector.html",410,320,FCKTools.Bind(b,b.SetColor));}FCKTextColorCommand.prototype._CreatePanelBody=function(h,e){function d(){var i=h.createElement("DIV");i.className="ColorDeselected";FCKTools.AddEventListenerEx(i,"mouseover",FCKTextColorCommand_OnMouseOver);FCKTools.AddEventListenerEx(i,"mouseout",FCKTextColorCommand_OnMouseOut);return i;}var k=e.appendChild(h.createElement("TABLE"));k.className="ForceBaseFont";k.style.tableLayout="fixed";k.cellPadding=0;k.cellSpacing=0;k.border=0;k.width=150;var g=k.insertRow(-1).insertCell(-1);g.colSpan=8;var c=g.appendChild(d());c.innerHTML='<table cellspacing="0" cellpadding="0" width="100%" border="0">			<tr>				<td><div class="ColorBoxBorder"><div class="ColorBox" style="background-color: #000000"></div></div></td>				<td nowrap width="100%" align="center">'+FCKLang.ColorAutomatic+"</td>			</tr>		</table>";FCKTools.AddEventListenerEx(c,"click",FCKTextColorCommand_AutoOnClick,this);if(!FCKBrowserInfo.IsIE){c.style.width="96%";}var m=FCKConfig.FontColors.toString().split(",");var l=0;while(l<m.length){var b=k.insertRow(-1);for(var f=0;f<8;f++,l++){if(l<m.length){var j=m[l].split("/");var a="#"+j[0];var n=j[1]||a;}c=b.insertCell(-1).appendChild(d());c.innerHTML='<div class="ColorBoxBorder"><div class="ColorBox" style="background-color: '+a+'"></div></div>';if(l>=m.length){c.style.visibility="hidden";}else{FCKTools.AddEventListenerEx(c,"click",FCKTextColorCommand_OnClick,[this,n]);}}}if(FCKConfig.EnableMoreFontColors){g=k.insertRow(-1).insertCell(-1);g.colSpan=8;c=g.appendChild(d());c.innerHTML='<table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td nowrap align="center">'+FCKLang.ColorMoreColors+"</td></tr></table>";FCKTools.AddEventListenerEx(c,"click",FCKTextColorCommand_MoreOnClick,this);if(!FCKBrowserInfo.IsIE){c.style.width="96%";}}};