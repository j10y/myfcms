FCK.ContextMenu=new Object();FCK.ContextMenu.Listeners=new Array();FCK.ContextMenu.RegisterListener=function(a){if(a){this.Listeners.push(a);}};function FCK_ContextMenu_Init(){var b=FCK.ContextMenu._InnerContextMenu=new FCKContextMenu(FCKBrowserInfo.IsIE?window:window.parent,FCKLang.Dir);b.CtrlDisable=FCKConfig.BrowserContextMenuOnCtrl;b.OnBeforeOpen=FCK_ContextMenu_OnBeforeOpen;b.OnItemClick=FCK_ContextMenu_OnItemClick;var a=FCK.ContextMenu;for(var c=0;c<FCKConfig.ContextMenu.length;c++){a.RegisterListener(FCK_ContextMenu_GetListener(FCKConfig.ContextMenu[c]));}}function FCK_ContextMenu_GetListener(a){switch(a){case"Generic":return{AddItems:function(d,b,c){d.AddItem("Cut",FCKLang.Cut,7,FCKCommands.GetCommand("Cut").GetState()==FCK_TRISTATE_DISABLED);d.AddItem("Copy",FCKLang.Copy,8,FCKCommands.GetCommand("Copy").GetState()==FCK_TRISTATE_DISABLED);d.AddItem("Paste",FCKLang.Paste,9,FCKCommands.GetCommand("Paste").GetState()==FCK_TRISTATE_DISABLED);}};case"Table":return{AddItems:function(g,b,e){var d=(e=="TABLE");var c=(!d&&FCKSelection.HasAncestorNode("TABLE"));if(c){g.AddSeparator();var f=g.AddItem("Cell",FCKLang.CellCM);f.AddItem("TableInsertCellBefore",FCKLang.InsertCellBefore,69);f.AddItem("TableInsertCellAfter",FCKLang.InsertCellAfter,58);f.AddItem("TableDeleteCells",FCKLang.DeleteCells,59);if(FCKBrowserInfo.IsGecko){f.AddItem("TableMergeCells",FCKLang.MergeCells,60,FCKCommands.GetCommand("TableMergeCells").GetState()==FCK_TRISTATE_DISABLED);}else{f.AddItem("TableMergeRight",FCKLang.MergeRight,60,FCKCommands.GetCommand("TableMergeRight").GetState()==FCK_TRISTATE_DISABLED);f.AddItem("TableMergeDown",FCKLang.MergeDown,60,FCKCommands.GetCommand("TableMergeDown").GetState()==FCK_TRISTATE_DISABLED);}f.AddItem("TableHorizontalSplitCell",FCKLang.HorizontalSplitCell,61,FCKCommands.GetCommand("TableHorizontalSplitCell").GetState()==FCK_TRISTATE_DISABLED);f.AddItem("TableVerticalSplitCell",FCKLang.VerticalSplitCell,61,FCKCommands.GetCommand("TableVerticalSplitCell").GetState()==FCK_TRISTATE_DISABLED);f.AddSeparator();f.AddItem("TableCellProp",FCKLang.CellProperties,57,FCKCommands.GetCommand("TableCellProp").GetState()==FCK_TRISTATE_DISABLED);g.AddSeparator();f=g.AddItem("Row",FCKLang.RowCM);f.AddItem("TableInsertRowBefore",FCKLang.InsertRowBefore,70);f.AddItem("TableInsertRowAfter",FCKLang.InsertRowAfter,62);f.AddItem("TableDeleteRows",FCKLang.DeleteRows,63);g.AddSeparator();f=g.AddItem("Column",FCKLang.ColumnCM);f.AddItem("TableInsertColumnBefore",FCKLang.InsertColumnBefore,71);f.AddItem("TableInsertColumnAfter",FCKLang.InsertColumnAfter,64);f.AddItem("TableDeleteColumns",FCKLang.DeleteColumns,65);}if(d||c){g.AddSeparator();g.AddItem("TableDelete",FCKLang.TableDelete);g.AddItem("TableProp",FCKLang.TableProperties,39);}}};case"Link":return{AddItems:function(g,b,d){var e=(d=="A"||FCKSelection.HasAncestorNode("A"));if(e||FCK.GetNamedCommandState("Unlink")!=FCK_TRISTATE_DISABLED){var f=FCKSelection.MoveToAncestorNode("A");var c=(f&&f.name.length>0&&f.href.length==0);if(c){return;}g.AddSeparator();g.AddItem("VisitLink",FCKLang.VisitLink);g.AddSeparator();if(e){g.AddItem("Link",FCKLang.EditLink,34);}g.AddItem("Unlink",FCKLang.RemoveLink,35);}}};case"Image":return{AddItems:function(d,b,c){if(c=="IMG"&&!b.getAttribute("_fckfakelement")){d.AddSeparator();d.AddItem("Image",FCKLang.ImageProperties,37);}}};case"Anchor":return{AddItems:function(f,b,d){var e=FCKSelection.MoveToAncestorNode("A");var c=(e&&e.name.length>0);if(c||(d=="IMG"&&b.getAttribute("_fckanchor"))){f.AddSeparator();f.AddItem("Anchor",FCKLang.AnchorProp,36);f.AddItem("AnchorDelete",FCKLang.AnchorDelete);}}};case"Flash":return{AddItems:function(d,b,c){if(c=="IMG"&&b.getAttribute("_fckflash")){d.AddSeparator();d.AddItem("Flash",FCKLang.FlashProperties,38);}}};case"Form":return{AddItems:function(d,b,c){if(FCKSelection.HasAncestorNode("FORM")){d.AddSeparator();d.AddItem("Form",FCKLang.FormProp,48);}}};case"Checkbox":return{AddItems:function(d,b,c){if(c=="INPUT"&&b.type=="checkbox"){d.AddSeparator();d.AddItem("Checkbox",FCKLang.CheckboxProp,49);}}};case"Radio":return{AddItems:function(d,b,c){if(c=="INPUT"&&b.type=="radio"){d.AddSeparator();d.AddItem("Radio",FCKLang.RadioButtonProp,50);}}};case"TextField":return{AddItems:function(d,b,c){if(c=="INPUT"&&(b.type=="text"||b.type=="password")){d.AddSeparator();d.AddItem("TextField",FCKLang.TextFieldProp,51);}}};case"HiddenField":return{AddItems:function(d,b,c){if(c=="IMG"&&b.getAttribute("_fckinputhidden")){d.AddSeparator();d.AddItem("HiddenField",FCKLang.HiddenFieldProp,56);}}};case"ImageButton":return{AddItems:function(d,b,c){if(c=="INPUT"&&b.type=="image"){d.AddSeparator();d.AddItem("ImageButton",FCKLang.ImageButtonProp,55);}}};case"Button":return{AddItems:function(d,b,c){if(c=="INPUT"&&(b.type=="button"||b.type=="submit"||b.type=="reset")){d.AddSeparator();d.AddItem("Button",FCKLang.ButtonProp,54);}}};case"Select":return{AddItems:function(d,b,c){if(c=="SELECT"){d.AddSeparator();d.AddItem("Select",FCKLang.SelectionFieldProp,53);}}};case"Textarea":return{AddItems:function(d,b,c){if(c=="TEXTAREA"){d.AddSeparator();d.AddItem("Textarea",FCKLang.TextareaProp,52);}}};case"BulletedList":return{AddItems:function(d,b,c){if(FCKSelection.HasAncestorNode("UL")){d.AddSeparator();d.AddItem("BulletedList",FCKLang.BulletedListProp,27);}}};case"NumberedList":return{AddItems:function(d,b,c){if(FCKSelection.HasAncestorNode("OL")){d.AddSeparator();d.AddItem("NumberedList",FCKLang.NumberedListProp,26);}}};case"DivContainer":return{AddItems:function(e,b,c){var d=FCKDomTools.GetSelectedDivContainers();if(d.length>0){e.AddSeparator();e.AddItem("EditDiv",FCKLang.EditDiv,75);e.AddItem("DeleteDiv",FCKLang.DeleteDiv,76);}}};}return null;}function FCK_ContextMenu_OnBeforeOpen(){FCK.Events.FireEvent("OnSelectionChange");var d,b;if((d=FCKSelection.GetSelectedElement())){b=d.tagName;}var a=FCK.ContextMenu._InnerContextMenu;a.RemoveAllItems();var e=FCK.ContextMenu.Listeners;for(var c=0;c<e.length;c++){e[c].AddItems(a,d,b);}}function FCK_ContextMenu_OnItemClick(a){if(!FCKBrowserInfo.IsIE){FCK.Focus();}FCKCommands.GetCommand(a.Name).Execute(a.CustomData);}