FCK.Description="FCKeditor for Internet Explorer 5.5+";FCK._GetBehaviorsStyle=function(){if(!FCK._BehaviorsStyle){var b=FCKConfig.BasePath;var c="";var a;a='<style type="text/css" _fcktemp="true">';if(FCKConfig.ShowBorders){c="url("+b+"css/behaviors/showtableborders.htc)";}a+="INPUT,TEXTAREA,SELECT,.FCK__Anchor,.FCK__PageBreak,.FCK__InputHidden";if(FCKConfig.DisableObjectResizing){a+=",IMG";c+=" url("+b+"css/behaviors/disablehandles.htc)";}a+=" { behavior: url("+b+"css/behaviors/disablehandles.htc) ; }";if(c.length>0){a+="TABLE { behavior: "+c+" ; }";}a+="</style>";FCK._BehaviorsStyle=a;}return FCK._BehaviorsStyle;};function Doc_OnMouseUp(){if(FCK.EditorWindow.event.srcElement.tagName=="HTML"){FCK.Focus();FCK.EditorWindow.event.cancelBubble=true;FCK.EditorWindow.event.returnValue=false;}}function Doc_OnPaste(){var a=FCK.EditorDocument.body;a.detachEvent("onpaste",Doc_OnPaste);var b=FCK.Paste(!FCKConfig.ForcePasteAsPlainText&&!FCKConfig.AutoDetectPasteFromWord);a.attachEvent("onpaste",Doc_OnPaste);return b;}function Doc_OnDblClick(){FCK.OnDoubleClick(FCK.EditorWindow.event.srcElement);FCK.EditorWindow.event.cancelBubble=true;}function Doc_OnSelectionChange(){if(!FCK.IsSelectionChangeLocked&&FCK.EditorDocument){FCK.Events.FireEvent("OnSelectionChange");}}function Doc_OnDrop(){if(FCK.MouseDownFlag){FCK.MouseDownFlag=false;return;}if(FCKConfig.ForcePasteAsPlainText){var a=FCK.EditorWindow.event;if(FCK._CheckIsPastingEnabled()||FCKConfig.ShowDropDialog){FCK.PasteAsPlainText(a.dataTransfer.getData("Text"));}a.returnValue=false;a.cancelBubble=true;}}FCK.InitializeBehaviors=function(a){this.EditorDocument.attachEvent("onmouseup",Doc_OnMouseUp);this.EditorDocument.body.attachEvent("onpaste",Doc_OnPaste);this.EditorDocument.body.attachEvent("ondrop",Doc_OnDrop);FCK.ContextMenu._InnerContextMenu.AttachToElement(FCK.EditorDocument.body);this.EditorDocument.attachEvent("onkeydown",FCK._KeyDownListener);this.EditorDocument.attachEvent("ondblclick",Doc_OnDblClick);this.EditorDocument.attachEvent("onbeforedeactivate",function(){FCKSelection.Save();});this.EditorDocument.attachEvent("onselectionchange",Doc_OnSelectionChange);FCKTools.AddEventListener(FCK.EditorDocument,"mousedown",Doc_OnMouseDown);};FCK.InsertHtml=function(c){c=FCKConfig.ProtectedSource.Protect(c);c=FCK.ProtectEvents(c);c=FCK.ProtectUrls(c);c=FCK.ProtectTags(c);FCKSelection.Restore();FCK.EditorWindow.focus();FCKUndo.SaveUndoStep();var a=FCKSelection.GetSelection();if(a.type.toLowerCase()=="control"){a.clear();}c='<span id="__fakeFCKRemove__" style="display:none;">fakeFCKRemove</span>'+c;a.createRange().pasteHTML(c);var b=FCK.EditorDocument.getElementById("__fakeFCKRemove__");if(b.parentNode.childNodes.length==1){b=b.parentNode;}b.removeNode(true);FCKDocumentProcessor.Process(FCK.EditorDocument);this.Events.FireEvent("OnSelectionChange");};FCK.SetInnerHtml=function(b){var a=FCK.EditorDocument;a.body.innerHTML='<div id="__fakeFCKRemove__">&nbsp;</div>'+b;a.getElementById("__fakeFCKRemove__").removeNode(true);};function FCK_PreloadImages(){var a=new FCKImagePreloader();a.AddImages(FCKConfig.PreloadImages);a.AddImages(FCKConfig.SkinPath+"fck_strip.gif");a.OnComplete=LoadToolbarSetup;a.Start();}function Document_OnContextMenu(){return(event.srcElement._FCKShowContextMenu==true);}document.oncontextmenu=Document_OnContextMenu;function FCK_Cleanup(){this.LinkedField=null;this.EditorWindow=null;this.EditorDocument=null;}FCK._ExecPaste=function(){if(FCK._PasteIsRunning){return true;}if(FCKConfig.ForcePasteAsPlainText){FCK.PasteAsPlainText();return false;}var b=FCK._CheckIsPastingEnabled(true);if(b===false){FCKTools.RunFunction(FCKDialog.OpenDialog,FCKDialog,["FCKDialog_Paste",FCKLang.Paste,"dialog/fck_paste.html",400,330,"Security"]);}else{if(FCKConfig.AutoDetectPasteFromWord&&b.length>0){var a=/<\w[^>]*(( class="?MsoNormal"?)|(="mso-))/gi;if(a.test(b)){if(confirm(FCKLang.PasteWordConfirm)){FCK.PasteFromWord();return false;}}}FCK._PasteIsRunning=true;FCK.ExecuteNamedCommand("Paste");delete FCK._PasteIsRunning;}return false;};FCK.PasteAsPlainText=function(e){if(!FCK._CheckIsPastingEnabled()){FCKDialog.OpenDialog("FCKDialog_Paste",FCKLang.PasteAsText,"dialog/fck_paste.html",400,330,"PlainText");return;}var b=null;if(!e){b=clipboardData.getData("Text");}else{b=e;}if(b&&b.length>0){b=FCKTools.HTMLEncode(b);b=FCKTools.ProcessLineBreaks(window,FCKConfig,b);var c=b.search("</p>");var a=b.search("<p>");if((c!=-1&&a!=-1&&c<a)||(c!=-1&&a==-1)){var d=b.substr(0,c);b=b.substr(c+4);this.InsertHtml(d);}FCKUndo.SaveLocked=true;this.InsertHtml(b);FCKUndo.SaveLocked=false;}};FCK._CheckIsPastingEnabled=function(a){FCK._PasteIsEnabled=false;document.body.attachEvent("onpaste",FCK_CheckPasting_Listener);var b=FCK.GetClipboardHTML();document.body.detachEvent("onpaste",FCK_CheckPasting_Listener);if(FCK._PasteIsEnabled){if(!a){b=true;}}else{b=false;}delete FCK._PasteIsEnabled;return b;};function FCK_CheckPasting_Listener(){FCK._PasteIsEnabled=true;}FCK.GetClipboardHTML=function(){var c=document.getElementById("___FCKHiddenDiv");if(!c){c=document.createElement("DIV");c.id="___FCKHiddenDiv";var b=c.style;b.position="absolute";b.visibility=b.overflow="hidden";b.width=b.height=1;document.body.appendChild(c);}c.innerHTML="";var d=document.body.createTextRange();d.moveToElementText(c);d.execCommand("Paste");var a=c.innerHTML;c.innerHTML="";return a;};FCK.CreateLink=function(a,d){var b=new Array();var k=FCKSelection.GetType()=="Control";var g=k&&FCKSelection.GetSelectedElement();if(!(k&&!FCKTools.GetElementAscensor(g,"a"))){FCK.ExecuteNamedCommand("Unlink",null,false,!!d);}if(a.length>0){if(k){var f=this.EditorDocument.createElement("A");f.href=a;var c=g;c.parentNode.insertBefore(f,c);c.parentNode.removeChild(c);f.appendChild(c);return[f];}var e="javascript:void(0);/*"+(new Date().getTime())+"*/";FCK.ExecuteNamedCommand("CreateLink",e,false,!!d);var j=this.EditorDocument.links;for(i=0;i<j.length;i++){var f=j[i];if(f.getAttribute("href",2)==e){var h=f.innerHTML;f.href=a;f.innerHTML=h;var l=f.lastChild;if(l&&l.nodeName=="BR"){FCKDomTools.InsertAfterNode(f,f.removeChild(l));}b.push(f);}}}return b;};function _FCK_RemoveDisabledAtt(){this.removeAttribute("disabled");}function Doc_OnMouseDown(a){var b=a.srcElement;if(b.nodeName&&b.nodeName.IEquals("input")&&b.type.IEquals(["radio","checkbox"])&&!b.disabled){b.disabled=true;FCKTools.SetTimeout(_FCK_RemoveDisabledAtt,1,b);}}