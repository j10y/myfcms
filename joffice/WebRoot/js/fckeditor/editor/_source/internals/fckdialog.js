var FCKDialog=(function(){var i;var a;var h;var b=window.parent;while(b.parent&&b.parent!=b){try{if(b.parent.document.domain!=document.domain){break;}if(b.parent.document.getElementsByTagName("frameset").length>0){break;}}catch(g){break;}b=b.parent;}var d=b.document;var f=function(){if(!a){a=FCKConfig.FloatingPanelsZIndex+999;}return ++a;};var c=function(){if(!h){return;}var e=FCKTools.IsStrictMode(d)?d.documentElement:d.body;FCKDomTools.SetElementStyles(h,{"width":Math.max(e.scrollWidth,e.clientWidth,d.scrollWidth||0)-1+"px","height":Math.max(e.scrollHeight,e.clientHeight,d.scrollHeight||0)-1+"px"});};return{OpenDialog:function(l,e,t,k,v,o,j){if(!i){this.DisplayMainCover();}var n={Title:e,Page:t,Editor:window,CustomValue:o,TopWindow:b};FCK.ToolbarSet.CurrentInstance.Selection.Save(true);var r=FCKTools.GetViewPaneSize(b);var s={"X":0,"Y":0};var u=FCKBrowserInfo.IsIE&&(!FCKBrowserInfo.IsIE7||!FCKTools.IsStrictMode(b.document));if(u){s=FCKTools.GetScrollPosition(b);}var m=Math.max(s.Y+(r.Height-v-20)/2,0);var p=Math.max(s.X+(r.Width-k-20)/2,0);var q=d.createElement("iframe");FCKTools.ResetStyles(q);q.src=FCKConfig.BasePath+"fckdialog.html";q.frameBorder=0;q.allowTransparency=true;FCKDomTools.SetElementStyles(q,{"position":(u)?"absolute":"fixed","top":m+"px","left":p+"px","width":k+"px","height":v+"px","zIndex":f()});q._DialogArguments=n;d.body.appendChild(q);q._ParentDialog=i;i=q;},OnDialogClose:function(j){var e=j.frameElement;FCKDomTools.RemoveNode(e);if(e._ParentDialog){i=e._ParentDialog;e._ParentDialog.contentWindow.SetEnabled(true);}else{if(!FCKBrowserInfo.IsIE){FCK.Focus();}this.HideMainCover();setTimeout(function(){i=null;},0);FCK.ToolbarSet.CurrentInstance.Selection.Release();}},DisplayMainCover:function(){h=d.createElement("div");FCKTools.ResetStyles(h);FCKDomTools.SetElementStyles(h,{"position":"absolute","zIndex":f(),"top":"0px","left":"0px","backgroundColor":FCKConfig.BackgroundBlockerColor});FCKDomTools.SetOpacity(h,FCKConfig.BackgroundBlockerOpacity);if(FCKBrowserInfo.IsIE&&!FCKBrowserInfo.IsIE7){var j=d.createElement("iframe");FCKTools.ResetStyles(j);j.hideFocus=true;j.frameBorder=0;j.src=FCKTools.GetVoidUrl();FCKDomTools.SetElementStyles(j,{"width":"100%","height":"100%","position":"absolute","left":"0px","top":"0px","filter":"progid:DXImageTransform.Microsoft.Alpha(opacity=0)"});h.appendChild(j);}FCKTools.AddEventListener(b,"resize",c);c();d.body.appendChild(h);FCKFocusManager.Lock();var e=FCK.ToolbarSet.CurrentInstance.GetInstanceObject("frameElement");e._fck_originalTabIndex=e.tabIndex;e.tabIndex=-1;},HideMainCover:function(){FCKDomTools.RemoveNode(h);FCKFocusManager.Unlock();var e=FCK.ToolbarSet.CurrentInstance.GetInstanceObject("frameElement");e.tabIndex=e._fck_originalTabIndex;FCKDomTools.ClearElementJSProperty(e,"_fck_originalTabIndex");},GetCover:function(){return h;}};})();