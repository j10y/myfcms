Ext.ux.Printer=function(){return{renderers:{},registerRenderer:function(b,a){this.renderers[b]=new (a)();},getRenderer:function(a){return this.renderers[a];},print:function(a){var d=a.getXTypes().split("/");for(var b=d.length-1;b>=0;b--){var e=d[b],c=this.getRenderer(e);if(c!=undefined){c.print(a);break;}}}};}();Ext.override(Ext.Component,{getXTypes:function(){var a=this.constructor;if(!a.xtypes){var e=[],b=this;while(b){var d=b.constructor.xtype;if(d!=undefined){e.unshift(d);}b=b.constructor.superclass;}a.xtypeChain=e;a.xtypes=e.join("/");}return a.xtypes;}});Ext.ux.Printer.BaseRenderer=Ext.extend(Object,{print:function(b){var a=b&&b.getXType?String.format("print_{0}_{1}",b.getXType(),b.id):"print";var c=window.open("",a);c.document.write(this.generateHTML(b));c.document.close();c.print();c.close();},generateHTML:function(a){return new Ext.XTemplate('<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">',"<html>","<head>",'<meta content="text/html; charset=UTF-8" http-equiv="Content-Type" />','<link href="'+this.stylesheetPath+'" rel="stylesheet" type="text/css" media="screen,print" />',"<title>"+this.getTitle(a)+"</title>","</head>","<body>",this.generateBody(a),"</body>","</html>").apply(this.prepareData(a));},generateBody:Ext.emptyFn,prepareData:function(a){return a;},getTitle:function(a){return typeof a.getTitle=="function"?a.getTitle():(a.title||"Printing");},stylesheetPath:__ctxPath+"/css/print.css"});Ext.ux.Printer.ColumnTreeRenderer=Ext.extend(Ext.ux.Printer.BaseRenderer,{generateBody:function(b){var c=this.getColumns(b);var d=this.headerTpl.apply(c);var a=this.bodyTpl.apply(c);return String.format('<table>{0}<tpl for=".">{1}</tpl></table>',d,a);},getColumns:function(a){return a.columns;},prepareData:function(a){var b=a.root,d=[],g=this.getColumns(a),e=this.indentPadding;var c=function(f){if(f.hidden===true||f.isHiddenRoot()===true){return;}var h=Ext.apply({depth:f.getDepth()*e},f.attributes);Ext.iterate(h,function(i,j){Ext.each(g,function(k){if(k.dataIndex==i){h[i]=k.renderer?k.renderer(j):j;}},this);});h[this.getColumns(a)[0].dataIndex]=f.attributes.text;d.push(h);};b.cascade(c,this);return d;},indentPadding:15,headerTpl:new Ext.XTemplate("<tr>",'<tpl for=".">','<th width="{width}">{header}</th>',"</tpl>","</tr>"),bodyTpl:new Ext.XTemplate("<tr>",'<tpl for=".">','<td style="padding-left: {[xindex == 1 ? "\\{depth\\}" : "0"]}px">{{dataIndex}}</td>',"</tpl>","</tr>")});Ext.ux.Printer.registerRenderer("columntree",Ext.ux.Printer.ColumnTreeRenderer);Ext.ux.Printer.GridPanelRenderer=Ext.extend(Ext.ux.Printer.BaseRenderer,{generateBody:function(c){var b=this.getColumns(c);var d=this.headerTpl.apply(b);var a=this.bodyTpl.apply(b);return String.format('<table>{0}<tpl for=".">{1}</tpl></table>',d,a);},prepareData:function(b){var a=this.getColumns(b);var c=[];b.store.data.each(function(d){var e={};Ext.iterate(d.data,function(f,g){Ext.each(a,function(h){if(h.dataIndex==f){e[f]=h.renderer?h.renderer(g,null,d):g;return false;}},this);});c.push(e);});return c;},getColumns:function(b){var a=[];Ext.each(b.getColumnModel().config,function(c){if(c.hidden!=true){a.push(c);}},this);return a;},headerTpl:new Ext.XTemplate("<tr>",'<tpl for=".">',"<th>{header}</th>","</tpl>","</tr>"),bodyTpl:new Ext.XTemplate("<tr>",'<tpl for=".">',"<td>{{dataIndex}}</td>","</tpl>","</tr>")});Ext.ux.Printer.registerRenderer("grid",Ext.ux.Printer.GridPanelRenderer);