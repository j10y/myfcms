var FCKKeystrokeHandler=function(a){this.Keystrokes=new Object();this.CancelCtrlDefaults=(a!==false);};FCKKeystrokeHandler.prototype.AttachToElement=function(a){FCKTools.AddEventListenerEx(a,"keydown",_FCKKeystrokeHandler_OnKeyDown,this);if(FCKBrowserInfo.IsGecko10||FCKBrowserInfo.IsOpera||(FCKBrowserInfo.IsGecko&&FCKBrowserInfo.IsMac)){FCKTools.AddEventListenerEx(a,"keypress",_FCKKeystrokeHandler_OnKeyPress,this);}};FCKKeystrokeHandler.prototype.SetKeystrokes=function(){for(var a=0;a<arguments.length;a++){var b=arguments[a];if(!b){continue;}if(typeof(b[0])=="object"){this.SetKeystrokes.apply(this,b);}else{if(b.length==1){delete this.Keystrokes[b[0]];}else{this.Keystrokes[b[0]]=b[1]===true?true:b;}}}};function _FCKKeystrokeHandler_OnKeyDown(d,a){var g=d.keyCode||d.which;var f=0;if(d.ctrlKey||d.metaKey){f+=CTRL;}if(d.shiftKey){f+=SHIFT;}if(d.altKey){f+=ALT;}var b=g+f;var c=a._CancelIt=false;var e=a.Keystrokes[b];if(e){if(e===true||!(a.OnKeystroke&&a.OnKeystroke.apply(a,e))){return true;}c=true;}if(c||(a.CancelCtrlDefaults&&f==CTRL&&(g<33||g>40))){a._CancelIt=true;if(d.preventDefault){return d.preventDefault();}d.returnValue=false;d.cancelBubble=true;return false;}return true;}function _FCKKeystrokeHandler_OnKeyPress(b,a){if(a._CancelIt){if(b.preventDefault){return b.preventDefault();}return false;}return true;}