var FCKToolbarStyleCombo=function(b,a){if(b===false){return;}this.CommandName="Style";this.Label=this.GetLabel();this.Tooltip=b?b:this.Label;this.Style=a?a:FCK_TOOLBARITEM_ICONTEXT;this.DefaultLabel=FCKConfig.DefaultStyleLabel||"";};FCKToolbarStyleCombo.prototype=new FCKToolbarSpecialCombo;FCKToolbarStyleCombo.prototype.GetLabel=function(){return FCKLang.Style;};FCKToolbarStyleCombo.prototype.GetStyles=function(){var d={};var b=FCK.ToolbarSet.CurrentInstance.Styles.GetStyles();for(var a in b){var c=b[a];if(!c.IsCore){d[a]=c;}}return d;};FCKToolbarStyleCombo.prototype.CreateItems=function(g){var c=g._Panel.Document;FCKTools.AppendStyleSheet(c,FCKConfig.ToolbarComboPreviewCSS);FCKTools.AppendStyleString(c,FCKConfig.EditorAreaStyles);c.body.className+=" ForceBaseFont";FCKConfig.ApplyBodyAttributes(c.body);var f=this.GetStyles();for(var b in f){var d=f[b];var a=d.GetType()==FCK_STYLE_OBJECT?b:FCKToolbarStyleCombo_BuildPreview(d,d.Label||b);var e=g.AddItem(b,a);e.Style=d;}g.OnBeforeClick=this.StyleCombo_OnBeforeClick;};FCKToolbarStyleCombo.prototype.RefreshActiveItems=function(j){var c=FCK.ToolbarSet.CurrentInstance.Selection.GetBoundaryParentElement(true);if(c){var h=new FCKElementPath(c);var f=h.Elements;for(var g=0;g<f.length;g++){for(var a in j.Items){var d=j.Items[a];var b=d.Style;if(b.CheckElementRemovable(f[g],true)){j.SetLabel(b.Label||b.Name);return;}}}}j.SetLabel(this.DefaultLabel);};FCKToolbarStyleCombo.prototype.StyleCombo_OnBeforeClick=function(h){h.DeselectAll();var e;var g;var b;var d=FCK.ToolbarSet.CurrentInstance.Selection;if(d.GetType()=="Control"){e=d.GetSelectedElement();b=e.nodeName.toLowerCase();}else{e=d.GetBoundaryParentElement(true);g=new FCKElementPath(e);}for(var a in h.Items){var f=h.Items[a];var c=f.Style;if((b&&c.Element==b)||(!b&&c.GetType()!=FCK_STYLE_OBJECT)){f.style.display="";if((g&&c.CheckActive(g))||(!g&&c.CheckElementRemovable(e,true))){h.SelectItem(c.Name);}}else{f.style.display="none";}}};function FCKToolbarStyleCombo_BuildPreview(e,c){var f=e.GetType();var d=[];if(f==FCK_STYLE_BLOCK){d.push('<div class="BaseFont">');}var a=e.Element;if(a=="bdo"){a="span";}d=["<",a];var g=e._StyleDesc.Attributes;if(g){for(var b in g){d.push(" ",b,'="',e.GetFinalAttributeValue(b),'"');}}if(e._GetStyleText().length>0){d.push(' style="',e.GetFinalStyleValue(),'"');}d.push(">",c,"</",a,">");if(f==FCK_STYLE_BLOCK){d.push("</div>");}return d.join("");}