FCKDomRange.prototype.MoveToSelection=function(){this.Release(true);var a=this.Window.getSelection();if(a&&a.rangeCount>0){this._Range=FCKW3CRange.CreateFromRange(this.Window.document,a.getRangeAt(0));this._UpdateElementInfo();}else{if(this.Window.document){this.MoveToElementStart(this.Window.document.body);}}};FCKDomRange.prototype.Select=function(){var f=this._Range;if(f){var c=f.startContainer;if(f.collapsed&&c.nodeType==1&&c.childNodes.length==0){c.appendChild(f._Document.createTextNode(""));}var b=this.Window.document.createRange();b.setStart(c,f.startOffset);try{b.setEnd(f.endContainer,f.endOffset);}catch(d){if(d.toString().Contains("NS_ERROR_ILLEGAL_VALUE")){f.collapse(true);b.setEnd(f.endContainer,f.endOffset);}else{throw (d);}}var a=this.Window.getSelection();a.removeAllRanges();a.addRange(b);}};FCKDomRange.prototype.SelectBookmark=function(e){var b=this.Window.document.createRange();var c=this.GetBookmarkNode(e,true);var a=this.GetBookmarkNode(e,false);b.setStart(c.parentNode,FCKDomTools.GetIndexOf(c));FCKDomTools.RemoveNode(c);if(a){b.setEnd(a.parentNode,FCKDomTools.GetIndexOf(a));FCKDomTools.RemoveNode(a);}var d=this.Window.getSelection();d.removeAllRanges();d.addRange(b);};