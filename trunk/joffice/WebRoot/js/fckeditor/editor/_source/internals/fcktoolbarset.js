function FCKToolbarSet_Create(overhideLocation){var oToolbarSet;var sLocation=overhideLocation||FCKConfig.ToolbarLocation;switch(sLocation){case"In":document.getElementById("xToolbarRow").style.display="";oToolbarSet=new FCKToolbarSet(document);break;case"None":oToolbarSet=new FCKToolbarSet(document);break;default:FCK.Events.AttachEvent("OnBlur",FCK_OnBlur);FCK.Events.AttachEvent("OnFocus",FCK_OnFocus);var eToolbarTarget;var oOutMatch=sLocation.match(/^Out:(.+)\((\w+)\)$/);if(oOutMatch){if(FCKBrowserInfo.IsAIR){FCKAdobeAIR.ToolbarSet_GetOutElement(window,oOutMatch);}else{eToolbarTarget=eval("parent."+oOutMatch[1]).document.getElementById(oOutMatch[2]);}}else{oOutMatch=sLocation.match(/^Out:(\w+)$/);if(oOutMatch){eToolbarTarget=parent.document.getElementById(oOutMatch[1]);}}if(!eToolbarTarget){alert('Invalid value for "ToolbarLocation"');return arguments.callee("In");}oToolbarSet=eToolbarTarget.__FCKToolbarSet;if(oToolbarSet){break;}var eToolbarIFrame=FCKTools.GetElementDocument(eToolbarTarget).createElement("iframe");eToolbarIFrame.src="javascript:void(0)";eToolbarIFrame.frameBorder=0;eToolbarIFrame.width="100%";eToolbarIFrame.height="10";eToolbarTarget.appendChild(eToolbarIFrame);eToolbarIFrame.unselectable="on";var eTargetDocument=eToolbarIFrame.contentWindow.document;var sBase="";if(FCKBrowserInfo.IsSafari){sBase='<base href="'+window.document.location+'">';}eTargetDocument.open();eTargetDocument.write("<html><head>"+sBase+'<script type="text/javascript"> var adjust = function() { window.frameElement.height = document.body.scrollHeight ; }; '+"window.onresize = window.onload = "+"function(){"+"var timer = null;"+"var lastHeight = -1;"+"var lastChange = 0;"+"var poller = function(){"+"var currentHeight = document.body.scrollHeight || 0;"+"var currentTime = (new Date()).getTime();"+"if (currentHeight != lastHeight){"+"lastChange = currentTime;"+"adjust();"+"lastHeight = document.body.scrollHeight;"+"}"+"if (lastChange < currentTime - 1000) clearInterval(timer);"+"};"+"timer = setInterval(poller, 100);"+"}"+'<\/script></head><body style="overflow: hidden">'+document.getElementById("xToolbarSpace").innerHTML+"</body></html>");eTargetDocument.close();if(FCKBrowserInfo.IsAIR){FCKAdobeAIR.ToolbarSet_InitOutFrame(eTargetDocument);}FCKTools.AddEventListener(eTargetDocument,"contextmenu",FCKTools.CancelEvent);FCKTools.AppendStyleSheet(eTargetDocument,FCKConfig.SkinEditorCSS);oToolbarSet=eToolbarTarget.__FCKToolbarSet=new FCKToolbarSet(eTargetDocument);oToolbarSet._IFrame=eToolbarIFrame;if(FCK.IECleanup){FCK.IECleanup.AddItem(eToolbarTarget,FCKToolbarSet_Target_Cleanup);}}oToolbarSet.CurrentInstance=FCK;if(!oToolbarSet.ToolbarItems){oToolbarSet.ToolbarItems=FCKToolbarItems;}FCK.AttachToOnSelectionChange(oToolbarSet.RefreshItemsState);return oToolbarSet;}function FCK_OnBlur(a){var b=a.ToolbarSet;if(b.CurrentInstance==a){b.Disable();}}function FCK_OnFocus(b){var c=b.ToolbarSet;var a=b||FCK;c.CurrentInstance.FocusManager.RemoveWindow(c._IFrame.contentWindow);c.CurrentInstance=a;a.FocusManager.AddWindow(c._IFrame.contentWindow,true);c.Enable();}function FCKToolbarSet_Cleanup(){this._TargetElement=null;this._IFrame=null;}function FCKToolbarSet_Target_Cleanup(){this.__FCKToolbarSet=null;}var FCKToolbarSet=function(b){this._Document=b;this._TargetElement=b.getElementById("xToolbar");var a=b.getElementById("xExpandHandle");var c=b.getElementById("xCollapseHandle");a.title=FCKLang.ToolbarExpand;FCKTools.AddEventListener(a,"click",FCKToolbarSet_Expand_OnClick);c.title=FCKLang.ToolbarCollapse;FCKTools.AddEventListener(c,"click",FCKToolbarSet_Collapse_OnClick);if(!FCKConfig.ToolbarCanCollapse||FCKConfig.ToolbarStartExpanded){this.Expand();}else{this.Collapse();}c.style.display=FCKConfig.ToolbarCanCollapse?"":"none";if(FCKConfig.ToolbarCanCollapse){c.style.display="";}else{b.getElementById("xTBLeftBorder").style.display="";}this.Toolbars=new Array();this.IsLoaded=false;if(FCK.IECleanup){FCK.IECleanup.AddItem(this,FCKToolbarSet_Cleanup);}};function FCKToolbarSet_Expand_OnClick(){FCK.ToolbarSet.Expand();}function FCKToolbarSet_Collapse_OnClick(){FCK.ToolbarSet.Collapse();}FCKToolbarSet.prototype.Expand=function(){this._ChangeVisibility(false);};FCKToolbarSet.prototype.Collapse=function(){this._ChangeVisibility(true);};FCKToolbarSet.prototype._ChangeVisibility=function(a){this._Document.getElementById("xCollapsed").style.display=a?"":"none";this._Document.getElementById("xExpanded").style.display=a?"none":"";if(window.onresize){FCKTools.RunFunction(window.onresize);}};FCKToolbarSet.prototype.Load=function(c){this.Name=c;this.Items=new Array();this.ItemsWysiwygOnly=new Array();this.ItemsContextSensitive=new Array();this._TargetElement.innerHTML="";var h=FCKConfig.ToolbarSets[c];if(!h){alert(FCKLang.UnknownToolbarSet.replace(/%1/g,c));return;}this.Toolbars=new Array();for(var b=0;b<h.length;b++){var f=h[b];if(!f){continue;}var e;if(typeof(f)=="string"){if(f=="/"){e=new FCKToolbarBreak();}}else{e=new FCKToolbar();for(var d=0;d<f.length;d++){var a=f[d];if(a=="-"){e.AddSeparator();}else{var g=FCKToolbarItems.GetItem(a);if(g){e.AddItem(g);this.Items.push(g);if(!g.SourceView){this.ItemsWysiwygOnly.push(g);}if(g.ContextSensitive){this.ItemsContextSensitive.push(g);}}}}}e.Create(this._TargetElement);this.Toolbars[this.Toolbars.length]=e;}FCKTools.DisableSelection(this._Document.getElementById("xCollapseHandle").parentNode);if(FCK.Status!=FCK_STATUS_COMPLETE){FCK.Events.AttachEvent("OnStatusChange",this.RefreshModeState);}else{this.RefreshModeState();}this.IsLoaded=true;this.IsEnabled=true;FCKTools.RunFunction(this.OnLoad);};FCKToolbarSet.prototype.Enable=function(){if(this.IsEnabled){return;}this.IsEnabled=true;var a=this.Items;for(var b=0;b<a.length;b++){a[b].RefreshState();}};FCKToolbarSet.prototype.Disable=function(){if(!this.IsEnabled){return;}this.IsEnabled=false;var a=this.Items;for(var b=0;b<a.length;b++){a[b].Disable();}};FCKToolbarSet.prototype.RefreshModeState=function(d){if(FCK.Status!=FCK_STATUS_COMPLETE){return;}var e=d?d.ToolbarSet:this;var a=e.ItemsWysiwygOnly;if(FCK.EditMode==FCK_EDITMODE_WYSIWYG){for(var c=0;c<a.length;c++){a[c].Enable();}e.RefreshItemsState(d);}else{e.RefreshItemsState(d);for(var b=0;b<a.length;b++){a[b].Disable();}}};FCKToolbarSet.prototype.RefreshItemsState=function(c){var a=(c?c.ToolbarSet:this).ItemsContextSensitive;for(var b=0;b<a.length;b++){a[b].RefreshState();}};