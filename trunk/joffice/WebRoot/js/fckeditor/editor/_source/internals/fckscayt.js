var FCKScayt;(function(){var l=[];var c=(FCK&&FCK.EditorWindow&&FCK.EditorWindow.parent.parent.scayt)?true:false;var h=false;var j=false;function f(x){if(c){return;}c=true;var u=FCK.EditorWindow.parent.parent;var w=function(){window.scayt=u.scayt;d();var y=FCKToolbarItems.LoadedItems["ScaytCombobox"];y&&y.SetEnabled(scyt_control&&scyt_control.disabled);g();};if(u.scayt){w();return;}if(FCK.Config.ScaytCustomUrl){FCK.Config.ScaytCustomUrl=new String(FCK.Config.ScaytCustomUrl).replace(new RegExp("^http[s]*://"),"");}var v=document.location.protocol;var s=FCK.Config.ScaytCustomUrl||"svc.spellchecker.net/spellcheck3/lf/scayt/scayt4.js";var q=v+"//"+s;var t=p(q).path+"/";var r=u.window.CKEDITOR||(u.window.CKEDITOR={});r._djScaytConfig={baseUrl:t,addOnLoad:function(){w();},isDebug:false};if(x){l.push(x);}e(q);}function e(q){if(!q){return false;}var t=FCK.EditorWindow.parent.parent;var r=t.document.createElement("script");r.type="text/javascript";r.src=q;t.document.getElementsByTagName("head")[0].appendChild(r);return true;}function p(r){var q=r.match(/(.*)[\/\\]([^\/\\]+\.\w+)$/);return q?{path:q[1],file:q[2]}:r;}function m(){var q={};var r=FCK.EditorWindow.parent.parent;q.srcNodeRef=FCK.EditingArea.IFrame;q.customerid=FCK.Config.ScaytCustomerid;q.customDictionaryName=FCK.Config.ScaytCustomDictionaryName;q.userDictionaryName=FCK.Config.ScaytUserDictionaryName;q.defLang=FCK.Config.ScaytDefLang;var s=r.scayt;var t=window.scayt_control=new s(q);}function d(){m();var t=window.scayt_control;if(t){t.setDisabled(false);j=true;h=!t.disabled;var q=FCKToolbarItems.LoadedItems["ScaytCombobox"];q&&q.Enable();k();}for(var r=0;r<l.length;r++){try{l[r].call(this);}catch(s){}}}var n=function(){name="Scayt";};n.prototype.Execute=function(r){switch(r){case"Options":case"Langs":case"About":if(c&&j&&!h){i("SCAYT is not enabled");break;}if(c&&j){FCKDialog.OpenDialog("Scayt","SCAYT Settings","dialog/fck_scayt.html?"+r.toLowerCase(),343,343);}break;default:if(!c){var q=this;f(function(){q.SetEnabled(!window.scayt_control.disabled);});return true;}else{if(j){if(h){this.Disable();}else{this.Enable();}k();}}}if(!c){return i("SCAYT is not loaded")||false;}if(!j){return i("SCAYT is not ready")||false;}return true;};n.prototype.Enable=function(){window.scayt_control.setDisabled(false);h=true;};n.prototype.Disable=function(){window.scayt_control.setDisabled(true);h=false;};n.prototype.SetEnabled=function(q){if(q){this.Enable();}else{this.Disable();}k();return true;};n.prototype.GetState=function(){return FCK_TRISTATE_OFF;};function k(){var r=FCKToolbarItems.GetItem("SpellCheck");if(!r||!r._Combo||!r._Combo._OuterTable){return;}var q=r._Combo._OuterTable.getElementsByTagName("img")[1];var s=r._Combo.Items["trigger"];if(h){q.style.opacity="1";s.innerHTML=o();}else{q.style.opacity="0.5";s.innerHTML=o();}}function o(){if(!j){return"<b>Enable SCAYT</b>";}return h?"<b>Disable SCAYT</b>":"<b>Enable SCAYT</b>";}var a=function(r,q){this.Command=FCKCommands.GetCommand("Scayt");this.CommandName="Scayt";this.Label=this.GetLabel();this.Tooltip=FCKLang.ScaytTitle;this.Style=FCK_TOOLBARITEM_ONLYTEXT;};a.prototype=new FCKToolbarSpecialCombo;a.prototype.CreateItems=function(){this._Combo.AddItem("Trigger","<b>Enable SCAYT</b>");this._Combo.AddItem("Options",FCKLang.ScaytTitleOptions||"Options");this._Combo.AddItem("Langs",FCKLang.ScaytTitleLangs||"Languages");this._Combo.AddItem("About",FCKLang.ScaytTitleAbout||"About");};a.prototype.GetLabel=function(){var q=FCKConfig.SkinPath+"fck_strip.gif";return FCKBrowserInfo.IsIE?'<div class="TB_Button_Image"><img src="'+q+'" style="top:-192px"></div>':'<img class="TB_Button_Image" src="'+FCK_SPACER_PATH+'" style="background-position: 0px -192px;background-image: url('+q+');">';};function i(q){q&&alert(q);}var b=function(){name="ScaytContext";};b.prototype.Execute=function(q){var s=q&&q.action,r=s&&q.node,u=window.scayt_control;if(r){switch(s){case"Suggestion":u.replace(r,q.suggestion);break;case"Ignore":u.ignore(r);break;case"Ignore All":u.ignoreAll(r);break;case"Add Word":var t=FCK.EditorWindow.parent.parent;t.scayt.addWordToUserDictionary(r);break;}}};function g(){FCK.ContextMenu.RegisterListener({AddItems:function(r){var z=FCK.EditorWindow.parent.parent;var t=window.scayt_control,q=z.scayt;if(!t){return;}var s=t.getScaytNode();if(!s){return;}var w=q.getSuggestion(t.getWord(s),t.getLang());if(!w||!w.length){return;}r.AddSeparator();var y=FCK.Config.ScaytMaxSuggestions||5;var x=(y==-1)?w.length:y;for(var v=0;v<x;v+=1){if(w[v]){r.AddItem("ScaytContext",w[v],null,false,{"action":"Suggestion","node":s,"suggestion":w[v]});}}r.AddSeparator();r.AddItem("ScaytContext","Ignore",null,false,{"action":"Ignore","node":s});r.AddItem("ScaytContext","Ignore All",null,false,{"action":"Ignore All","node":s});r.AddItem("ScaytContext","Add Word",null,false,{"action":"Add Word","node":s});try{if(j&&h){t.fireOnContextMenu(null,FCK.ContextMenu._InnerContextMenu);}}catch(u){}}});FCK.Events.AttachEvent("OnPaste",function(){window.scayt_control.refresh();return true;});}FCK.Events.AttachEvent("OnAfterSetHTML",function(){if(FCKConfig.SpellChecker=="SCAYT"){if(!c&&FCK.Config.ScaytAutoStartup){f();}if(FCK.EditMode==FCK_EDITMODE_WYSIWYG&&c&&j){m();}k();}});FCK.Events.AttachEvent("OnBeforeGetData",function(){j&&window.scayt_control.reset();});FCK.Events.AttachEvent("OnAfterGetData",function(){j&&window.scayt_control.refresh();});FCKScayt={CreateCommand:function(){return new n();},CreateContextCommand:function(){return new b();},CreateToolbarItem:function(){return new a();}};})();