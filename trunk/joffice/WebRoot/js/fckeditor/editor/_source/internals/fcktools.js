var FCKTools=new Object();FCKTools.CreateBogusBR=function(a){var b=a.createElement("br");b.setAttribute("type","_moz");return b;};FCKTools.FixCssUrls=function(a,b){if(!a||a.length==0){return b;}return b.replace(/url\s*\(([\s'"]*)(.*?)([\s"']*)\)/g,function(c,d,e,f){if(/^\/|^\w?:/.test(e)){return c;}else{return"url("+d+a+e+f+")";}});};FCKTools._GetUrlFixedCss=function(c,b){var a=c.match(/^([^|]+)\|([\s\S]*)/);if(a){return FCKTools.FixCssUrls(a[1],a[2]);}else{return c;}};FCKTools.AppendStyleSheet=function(d,c){if(!c){return[];}if(typeof(c)=="string"){if(/[\\\/\.][^{}]*$/.test(c)){return this.AppendStyleSheet(d,c.split(","));}else{return[this.AppendStyleString(d,FCKTools._GetUrlFixedCss(c))];}}else{var b=[];for(var a=0;a<c.length;a++){b.push(this._AppendStyleSheet(d,c[a]));}return b;}};FCKTools.GetStyleHtml=(function(){var a=function(e,d){if(e.length==0){return"";}var c=d?' _fcktemp="true"':"";return"<"+'style type="text/css"'+c+">"+e+"<"+"/style>";};var b=function(c,e){if(c.length==0){return"";}var d=e?' _fcktemp="true"':"";return"<"+'link href="'+c+'" type="text/css" rel="stylesheet" '+d+"/>";};return function(f,e){if(!f){return"";}if(typeof(f)=="string"){if(/[\\\/\.][^{}]*$/.test(f)){return this.GetStyleHtml(f.split(","),e);}else{return a(this._GetUrlFixedCss(f),e);}}else{var d="";for(var c=0;c<f.length;c++){d+=b(f[c],e);}return d;}};})();FCKTools.GetElementDocument=function(a){return a.ownerDocument||a.document;};FCKTools.GetElementWindow=function(a){return this.GetDocumentWindow(this.GetElementDocument(a));};FCKTools.GetDocumentWindow=function(a){if(FCKBrowserInfo.IsSafari&&!a.parentWindow){this.FixDocumentParentWindow(window.top);}return a.parentWindow||a.defaultView;};FCKTools.FixDocumentParentWindow=function(b){if(b.document){b.document.parentWindow=b;}for(var a=0;a<b.frames.length;a++){FCKTools.FixDocumentParentWindow(b.frames[a]);}};FCKTools.HTMLEncode=function(a){if(!a){return"";}a=a.replace(/&/g,"&amp;");a=a.replace(/</g,"&lt;");a=a.replace(/>/g,"&gt;");return a;};FCKTools.HTMLDecode=function(a){if(!a){return"";}a=a.replace(/&gt;/g,">");a=a.replace(/&lt;/g,"<");a=a.replace(/&amp;/g,"&");return a;};FCKTools._ProcessLineBreaksForPMode=function(l,o,k,b,f){var m=0;var e="<p>";var g="</p>";var h="<br />";if(k){e="<li>";g="</li>";m=1;}while(b&&b!=l.FCK.EditorDocument.body){if(b.tagName.toLowerCase()=="p"){m=1;break;}b=b.parentNode;}for(var d=0;d<o.length;d++){var j=o.charAt(d);if(j=="\r"){continue;}if(j!="\n"){f.push(j);continue;}var a=o.charAt(d+1);if(a=="\r"){d++;a=o.charAt(d+1);}if(a=="\n"){d++;if(m){f.push(g);}f.push(e);m=1;}else{f.push(h);}}};FCKTools._ProcessLineBreaksForDivMode=function(j,l,h,a,e){var k=0;var d="<div>";var f="</div>";if(h){d="<li>";f="</li>";k=1;}while(a&&a!=j.FCK.EditorDocument.body){if(a.tagName.toLowerCase()=="div"){k=1;break;}a=a.parentNode;}for(var b=0;b<l.length;b++){var g=l.charAt(b);if(g=="\r"){continue;}if(g!="\n"){e.push(g);continue;}if(k){if(e[e.length-1]==d){e.push("&nbsp;");}e.push(f);}e.push(d);k=1;}if(k){e.push(f);}};FCKTools._ProcessLineBreaksForBrMode=function(j,l,h,a,e){var k=0;var d="<br />";var f="";if(h){d="<li>";f="</li>";k=1;}for(var b=0;b<l.length;b++){var g=l.charAt(b);if(g=="\r"){continue;}if(g!="\n"){e.push(g);continue;}if(k&&f.length){e.push(f);}e.push(d);k=1;}};FCKTools.ProcessLineBreaks=function(g,e,h){var c=e.EnterMode.toLowerCase();var a=[];var f=0;var b=new g.FCKDomRange(g.FCK.EditorWindow);b.MoveToSelection();var d=b._Range.startContainer;while(d&&d.nodeType!=1){d=d.parentNode;}if(d&&d.tagName.toLowerCase()=="li"){f=1;}if(c=="p"){this._ProcessLineBreaksForPMode(g,h,f,d,a);}else{if(c=="div"){this._ProcessLineBreaksForDivMode(g,h,f,d,a);}else{if(c=="br"){this._ProcessLineBreaksForBrMode(g,h,f,d,a);}}}return a.join("");};FCKTools.AddSelectOption=function(a,d,c){var b=FCKTools.GetElementDocument(a).createElement("OPTION");b.text=d;b.value=c;a.options.add(b);return b;};FCKTools.RunFunction=function(c,a,d,b){if(c){this.SetTimeout(c,0,a,d,b);}};FCKTools.SetTimeout=function(d,c,a,e,b){return(b||window).setTimeout(function(){if(e){d.apply(a,[].concat(e));}else{d.apply(a);}},c);};FCKTools.SetInterval=function(d,c,a,e,b){return(b||window).setInterval(function(){d.apply(a,e||[]);},c);};FCKTools.ConvertStyleSizeToHtml=function(a){return a.EndsWith("%")?a:parseInt(a,10);};FCKTools.ConvertHtmlSizeToStyle=function(a){return a.EndsWith("%")?a:(a+"px");};FCKTools.GetElementAscensor=function(b,a){var c=b;var d=","+a.toUpperCase()+",";while(c){if(d.indexOf(","+c.nodeName.toUpperCase()+",")!=-1){return c;}c=c.parentNode;}return null;};FCKTools.CreateEventListener=function(a,c){var b=function(){var e=[];for(var d=0;d<arguments.length;d++){e.push(arguments[d]);}a.apply(this,e.concat(c));};return b;};FCKTools.IsStrictMode=function(a){return("CSS1Compat"==(a.compatMode||(FCKBrowserInfo.IsSafari?"CSS1Compat":null)));};FCKTools.ArgumentsToArray=function(b,e,a){e=e||0;a=a||b.length;var d=new Array();for(var c=e;c<e+a&&c<b.length;c++){d.push(b[c]);}return d;};FCKTools.CloneObject=function(b){var a=function(){};a.prototype=b;return new a;};FCKTools.AppendBogusBr=function(b){if(!b){return;}var a=this.GetLastItem(b.getElementsByTagName("br"));if(!a||(a.getAttribute("type",2)!="_moz"&&a.getAttribute("_moz_dirty")==null)){var c=this.GetElementDocument(b);if(FCKBrowserInfo.IsOpera){b.appendChild(c.createTextNode(""));}else{b.appendChild(this.CreateBogusBR(c));}}};FCKTools.GetLastItem=function(a){if(a.length>0){return a[a.length-1];}return null;};FCKTools.GetDocumentPosition=function(c,f){var a=0;var h=0;var e=f;var b=null;var d=FCKTools.GetElementWindow(e);while(e&&!(d==c&&(e==c.document.body||e==c.document.documentElement))){a+=e.offsetLeft-e.scrollLeft;h+=e.offsetTop-e.scrollTop;if(!FCKBrowserInfo.IsOpera){var g=b;while(g&&g!=e){a-=g.scrollLeft;h-=g.scrollTop;g=g.parentNode;}}b=e;if(e.offsetParent){e=e.offsetParent;}else{if(d!=c){e=d.frameElement;b=null;if(e){d=e.contentWindow.parent;}}else{e=null;}}}if(FCKDomTools.GetCurrentElementStyle(c.document.body,"position")!="static"||(FCKBrowserInfo.IsIE&&FCKDomTools.GetPositionedAncestor(f)==null)){a+=c.document.body.offsetLeft;h+=c.document.body.offsetTop;}return{"x":a,"y":h};};FCKTools.GetWindowPosition=function(b,c){var d=this.GetDocumentPosition(b,c);var a=FCKTools.GetScrollPosition(b);d.x-=a.X;d.y-=a.Y;return d;};FCKTools.ProtectFormStyles=function(f){if(!f||f.nodeType!=1||f.tagName.toLowerCase()!="form"){return[];}var e=[];var d=["style","className"];for(var c=0;c<d.length;c++){var b=d[c];if(f.elements.namedItem(b)){var a=f.elements.namedItem(b);e.push([a,a.nextSibling]);f.removeChild(a);}}return e;};FCKTools.RestoreFormStyles=function(e,d){if(!e||e.nodeType!=1||e.tagName.toLowerCase()!="form"){return;}if(d.length>0){for(var a=d.length-1;a>=0;a--){var c=d[a][0];var b=d[a][1];if(b){e.insertBefore(c,b);}else{e.appendChild(c);}}}};FCKTools.GetNextNode=function(b,c){if(b.firstChild){return b.firstChild;}else{if(b.nextSibling){return b.nextSibling;}else{var a=b.parentNode;while(a){if(a==c){return null;}if(a.nextSibling){return a.nextSibling;}else{a=a.parentNode;}}}}return null;};FCKTools.GetNextTextNode=function(a,b,c){node=this.GetNextNode(a,b);if(c&&node&&c(node)){return null;}while(node&&node.nodeType!=3){node=this.GetNextNode(node,b);if(c&&node&&c(node)){return null;}}return node;};FCKTools.Merge=function(){var b=arguments;var e=b[0];for(var c=1;c<b.length;c++){var a=b[c];for(var d in a){e[d]=a[d];}}return e;};FCKTools.IsArray=function(a){return(a instanceof Array);};FCKTools.AppendLengthProperty=function(c,b){var a=0;for(var d in c){a++;}return c[b||"length"]=a;};FCKTools.NormalizeCssText=function(a){var b=document.createElement("span");b.style.cssText=a;return b.style.cssText;};FCKTools.Bind=function(a,b){return function(){return b.apply(a,arguments);};};FCKTools.GetVoidUrl=function(){if(FCK_IS_CUSTOM_DOMAIN){return"javascript: void( function(){"+"document.open();"+"document.write('<html><head><title></title></head><body></body></html>');"+"document.domain = '"+FCK_RUNTIME_DOMAIN+"';"+"document.close();"+"}() ) ;";}if(FCKBrowserInfo.IsIE){if(FCKBrowserInfo.IsIE7||!FCKBrowserInfo.IsIE6){return"";}else{return"javascript: '';";}}return"javascript: void(0);";};FCKTools.ResetStyles=function(a){a.style.cssText="margin:0;"+"padding:0;"+"border:0;"+"background-color:transparent;"+"background-image:none;";};