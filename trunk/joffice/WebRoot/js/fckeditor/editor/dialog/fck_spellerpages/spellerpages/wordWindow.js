function wordWindow(){this._forms=[];this._getWordObject=_getWordObject;this._wordInputStr=_wordInputStr;this._adjustIndexes=_adjustIndexes;this._isWordChar=_isWordChar;this._lastPos=_lastPos;this.wordChar=/[a-zA-Z]/;this.windowType="wordWindow";this.originalSpellings=new Array();this.suggestions=new Array();this.checkWordBgColor="pink";this.normWordBgColor="white";this.text="";this.textInputs=new Array();this.indexes=new Array();this.resetForm=resetForm;this.totalMisspellings=totalMisspellings;this.totalWords=totalWords;this.totalPreviousWords=totalPreviousWords;this.getTextVal=getTextVal;this.setFocus=setFocus;this.removeFocus=removeFocus;this.setText=setText;this.writeBody=writeBody;this.printForHtml=printForHtml;}function resetForm(){if(this._forms){for(var a=0;a<this._forms.length;a++){this._forms[a].reset();}}return true;}function totalMisspellings(){var b=0;for(var a=0;a<this.textInputs.length;a++){b+=this.totalWords(a);}return b;}function totalWords(a){return this.originalSpellings[a].length;}function totalPreviousWords(d,a){var e=0;for(var c=0;c<=d;c++){for(var b=0;b<this.totalWords(c);b++){if(c==d&&b==a){break;}else{e++;}}}return e;}function getTextVal(b,a){var c=this._getWordObject(b,a);if(c){return c.value;}}function setFocus(b,a){var c=this._getWordObject(b,a);if(c){if(c.type=="text"){c.focus();c.style.backgroundColor=this.checkWordBgColor;}}}function removeFocus(b,a){var c=this._getWordObject(b,a);if(c){if(c.type=="text"){c.blur();c.style.backgroundColor=this.normWordBgColor;}}}function setText(b,d,e){var a=this._getWordObject(b,d);var f;var c;if(a){var g=this.indexes[b][d];var i=a.value;f=this.textInputs[b].substring(0,g);c=this.textInputs[b].substring(g+i.length,this.textInputs[b].length);this.textInputs[b]=f+e+c;var h=e.length-i.length;this._adjustIndexes(b,d,h);a.size=e.length;a.value=e;this.removeFocus(b,d);}}function writeBody(){var e=window.document;var a=false;e.open();for(var m=0;m<this.textInputs.length;m++){var l=0;var k=0;e.writeln('<form name="textInput'+m+'">');var n=this.textInputs[m];this.indexes[m]=[];if(n){var h=this.originalSpellings[m];if(!h){break;}e.writeln('<div class="plainText">');for(var c=0;c<h.length;c++){do{k=n.indexOf(h[c],l);l=k+h[c].length;if(k==-1){break;}var g=n.charAt(k-1);var f=n.charAt(l);}while(this._isWordChar(g)||this._isWordChar(f));this.indexes[m][c]=k;for(var b=this._lastPos(m,c);b<k;b++){e.write(this.printForHtml(n.charAt(b)));}e.write(this._wordInputStr(h[c]));if(c==h.length-1){e.write(printForHtml(n.substr(l)));}}e.writeln("</div>");}e.writeln("</form>");}this._forms=e.forms;e.close();}function _lastPos(b,a){if(a>0){return this.indexes[b][a-1]+this.originalSpellings[b][a-1].length;}else{return 0;}}function printForHtml(a){return a;}function _isWordChar(a){if(a.search(this.wordChar)==-1){return false;}else{return true;}}function _getWordObject(b,a){if(this._forms[b]){if(this._forms[b].elements[a]){return this._forms[b].elements[a];}}return null;}function _wordInputStr(a){var b="<input readonly ";b+='class="blend" type="text" value="'+a+'" size="'+a.length+'">';return b;}function _adjustIndexes(d,a,b){for(var c=a+1;c<this.originalSpellings[d].length;c++){this.indexes[d][c]=this.indexes[d][c]+b;}}