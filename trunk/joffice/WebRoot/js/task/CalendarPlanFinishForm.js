var CalendarPlanFinishForm=function(d){this.planId=d;var a=this.setup();var c=new Ext.Panel({autoHeight:true,width:530,border:false,autoLoad:{url:__ctxPath+"/pages/task/calendarplandetail.jsp?planId="+d}});var b=new Ext.Window({id:"CalendarPlanFinishFormWin",title:"完成任务",width:560,height:420,iconCls:"menu-cal-plan",modal:true,layout:"anchor",plain:true,bodyStyle:"padding:5px;",buttonAlign:"center",items:[c,this.setup()],buttons:[{text:"完成任务",id:"calendarPlanFinishBtn",iconCls:"btn-save",handler:function(){var e=Ext.getCmp("CalendarPlanFinishForm");if(e.getForm().isValid()){e.getForm().submit({method:"post",params:{"calendarPlan.status":1},waitMsg:"正在提交数据...",success:function(f,h){Ext.ux.Toast.msg("操作信息","成功保存信息！");var g=Ext.getCmp("CalendarPlanGrid");if(g!=null){g.getStore().reload();}b.close();},failure:function(f,g){Ext.MessageBox.show({title:"操作信息",msg:"信息保存出错，请联系管理员！",buttons:Ext.MessageBox.OK,icon:"ext-mb-error"});b.close();}});}}},{text:"取消",iconCls:"btn-cancel",handler:function(){b.close();}}]});b.show();};CalendarPlanFinishForm.prototype.setup=function(){var a=new Ext.FormPanel({url:__ctxPath+"/task/saveCalendarPlan.do",layout:"form",id:"CalendarPlanFinishForm",frame:true,defaults:{anchor:"98%,98%"},items:[{name:"calendarPlan.planId",id:"planId",xtype:"hidden",value:this.planId==null?"":this.planId},{xtype:"textarea",fieldLabel:"反馈",allowBlank:false,name:"calendarPlan.feedback",id:"feedback"}]});if(this.planId!=null&&this.planId!=undefined){a.getForm().load({deferredRender:false,url:__ctxPath+"/task/getCalendarPlan.do?planId="+this.planId,waitMsg:"正在载入数据...",success:function(b,c){var d=c.result.data;if(d.status==1){Ext.getCmp("calendarPlanFinishBtn").setDisabled(true);}},failure:function(b,c){}});}return a;};